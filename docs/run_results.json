{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-09-04T13:48:20.641423Z", "invocation_id": "0e18959b-43e5-46ad-8d1a-c065a59eba27", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.368292Z", "completed_at": "2024-09-04T13:48:19.375939Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.377362Z", "completed_at": "2024-09-04T13:48:19.377370Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03989601135253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.370620Z", "completed_at": "2024-09-04T13:48:19.376228Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.377806Z", "completed_at": "2024-09-04T13:48:19.377811Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039907217025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.365253Z", "completed_at": "2024-09-04T13:48:19.376715Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.378745Z", "completed_at": "2024-09-04T13:48:19.378749Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.042520999908447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.341380Z", "completed_at": "2024-09-04T13:48:19.377140Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.379416Z", "completed_at": "2024-09-04T13:48:19.379420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044319868087768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.383311Z", "completed_at": "2024-09-04T13:48:19.397810Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.398897Z", "completed_at": "2024-09-04T13:48:19.398902Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01848292350769043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.388946Z", "completed_at": "2024-09-04T13:48:19.398355Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.399938Z", "completed_at": "2024-09-04T13:48:19.399941Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018314838409423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.394773Z", "completed_at": "2024-09-04T13:48:19.398535Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.400117Z", "completed_at": "2024-09-04T13:48:19.400119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01825714111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.385801Z", "completed_at": "2024-09-04T13:48:19.398712Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.400291Z", "completed_at": "2024-09-04T13:48:19.400293Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019832849502563477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.408601Z", "completed_at": "2024-09-04T13:48:19.409270Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.411162Z", "completed_at": "2024-09-04T13:48:19.411168Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009050846099853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.409489Z", "completed_at": "2024-09-04T13:48:19.410066Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.411430Z", "completed_at": "2024-09-04T13:48:19.411435Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009234905242919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_ad_group_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.403747Z", "completed_at": "2024-09-04T13:48:19.410939Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.413152Z", "completed_at": "2024-09-04T13:48:19.413156Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012213945388793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.406800Z", "completed_at": "2024-09-04T13:48:19.411730Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.413748Z", "completed_at": "2024-09-04T13:48:19.413751Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011955976486206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        \n    select \n        cast(null as string) as _dbt_source_relation\n    limit 0", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.416126Z", "completed_at": "2024-09-04T13:48:19.416845Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.419594Z", "completed_at": "2024-09-04T13:48:19.419597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007798910140991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_advertiser_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.417034Z", "completed_at": "2024-09-04T13:48:19.417640Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.419791Z", "completed_at": "2024-09-04T13:48:19.419794Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007897138595581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_advertiser_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.418757Z", "completed_at": "2024-09-04T13:48:19.419381Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.422824Z", "completed_at": "2024-09-04T13:48:19.422827Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00785517692565918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.419984Z", "completed_at": "2024-09-04T13:48:19.421563Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.423404Z", "completed_at": "2024-09-04T13:48:19.423407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006803274154663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_campaign_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.425761Z", "completed_at": "2024-09-04T13:48:19.426331Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.428692Z", "completed_at": "2024-09-04T13:48:19.428695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006030082702636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.426506Z", "completed_at": "2024-09-04T13:48:19.427017Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.428860Z", "completed_at": "2024-09-04T13:48:19.428863Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006086826324462891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_keyword_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.427997Z", "completed_at": "2024-09-04T13:48:19.428518Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.430626Z", "completed_at": "2024-09-04T13:48:19.430629Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0059359073638916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_pin_promotion_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.429026Z", "completed_at": "2024-09-04T13:48:19.429532Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.431160Z", "completed_at": "2024-09-04T13:48:19.431163Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005315065383911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_source_integration_tests.pinterest_pin_promotion_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.441666Z", "completed_at": "2024-09-04T13:48:19.889124Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.890540Z", "completed_at": "2024-09-04T13:48:19.890545Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.453660249710083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_history_tmp`\n), \n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    campaign_id\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as timestamp) as \n    \n    end_time\n    \n , \n    cast(null as string) as \n    \n    id\n    \n , \n    cast(null as string) as \n    \n    ad_account_id\n    \n , \n    cast(null as string) as \n    \n    name\n    \n , \n    cast(null as string) as \n    \n    pacing_delivery_type\n    \n , \n    cast(null as string) as \n    \n    placement_group\n    \n , \n    cast(null as timestamp) as \n    \n    start_time\n    \n , \n    cast(null as string) as \n    \n    status\n    \n , \n    cast(null as string) as \n    \n    summary_status\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as ad_group_id,\n        name as ad_group_name,\n        status as ad_group_status,\n        ad_account_id as advertiser_id,\n        _fivetran_synced,\n        cast(campaign_id as string) as campaign_id,\n        created_time as created_at,\n        end_time,\n        pacing_delivery_type,\n        placement_group,\n        start_time,\n        summary_status,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.435688Z", "completed_at": "2024-09-04T13:48:19.889337Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.890709Z", "completed_at": "2024-09-04T13:48:19.890712Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.45966482162475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_1\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_2\n    \n , \n    cast(null as timestamp) as \n    \n    date\n    \n , \n    cast(null as INT64) as \n    \n    impression_1\n    \n , \n    cast(null as INT64) as \n    \n    impression_2\n    \n , \n    cast(null as INT64) as \n    \n    spend_in_micro_dollar\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_quantity\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_value_in_micro_dollar\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \t\n\n\t\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.439058Z", "completed_at": "2024-09-04T13:48:19.889559Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.890872Z", "completed_at": "2024-09-04T13:48:19.890875Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4585120677947998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    ad_group_id\n    \n , \n    cast(null as string) as \n    \n    ad_group_name\n    \n , \n    cast(null as string) as \n    \n    ad_group_status\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as INT64) as \n    \n    campaign_id\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_1\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_2\n    \n , \n    cast(null as timestamp) as \n    \n    date\n    \n , \n    cast(null as INT64) as \n    \n    impression_1\n    \n , \n    cast(null as INT64) as \n    \n    impression_2\n    \n , \n    cast(null as INT64) as \n    \n    spend_in_micro_dollar\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_quantity\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_value_in_micro_dollar\n    \n , \n    cast(null as string) as t_view_checkout \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \t\n\n\t\n    \t\n        \t\n    \t\n        \t\n            \t\n                , coalesce(cast(t_view_checkout as FLOAT64), 0) as t_view_checkout\t\n            \t\n        \t\n    \t\n\t\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.433753Z", "completed_at": "2024-09-04T13:48:19.889747Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:19.891034Z", "completed_at": "2024-09-04T13:48:19.891037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4606289863586426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    country\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as string) as \n    \n    currency\n    \n , \n    cast(null as string) as \n    \n    id\n    \n , \n    cast(null as string) as \n    \n    owner_user_id\n    \n , \n    cast(null as string) as \n    \n    owner_username\n    \n , \n    cast(null as string) as \n    \n    name\n    \n , \n    cast(null as string) as advertiser_permissions , \n    cast(null as timestamp) as \n    \n    updated_time\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as string) as advertiser_id,\n        name as advertiser_name,\n        country,\n        created_time as created_at,\n        currency as currency_code,\n        owner_user_id,\n        owner_username,\n        advertiser_permissions, -- permissions was renamed in macro\n        updated_time as updated_at,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.901442Z", "completed_at": "2024-09-04T13:48:20.238960Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.239819Z", "completed_at": "2024-09-04T13:48:20.239829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.34626126289367676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as string) as \n    \n    campaign_id\n    \n , \n    cast(null as string) as \n    \n    campaign_name\n    \n , \n    cast(null as string) as \n    \n    campaign_status\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_1\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_2\n    \n , \n    cast(null as timestamp) as \n    \n    date\n    \n , \n    cast(null as INT64) as \n    \n    impression_1\n    \n , \n    cast(null as INT64) as \n    \n    impression_2\n    \n , \n    cast(null as INT64) as \n    \n    spend_in_micro_dollar\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_quantity\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_value_in_micro_dollar\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(campaign_id as string) as campaign_id,\n        campaign_name,\n        campaign_status,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \t\n\n\t\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.899191Z", "completed_at": "2024-09-04T13:48:20.283446Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.284478Z", "completed_at": "2024-09-04T13:48:20.284484Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.39140892028808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    ad_group_id\n    \n , \n    cast(null as string) as \n    \n    ad_group_name\n    \n , \n    cast(null as string) as \n    \n    ad_group_status\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as string) as \n    \n    campaign_id\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_1\n    \n , \n    cast(null as INT64) as \n    \n    clickthrough_2\n    \n , \n    cast(null as timestamp) as \n    \n    date\n    \n , \n    cast(null as INT64) as \n    \n    impression_1\n    \n , \n    cast(null as INT64) as \n    \n    impression_2\n    \n , \n    cast(null as string) as \n    \n    keyword_id\n    \n , \n    cast(null as string) as \n    \n    pin_promotion_id\n    \n , \n    cast(null as INT64) as \n    \n    spend_in_micro_dollar\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_quantity\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_value_in_micro_dollar\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(keyword_id as string) as keyword_id,\n        cast(pin_promotion_id as string) as pin_promotion_id,\n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \t\n\n\t\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.897213Z", "completed_at": "2024-09-04T13:48:20.283974Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.285648Z", "completed_at": "2024-09-04T13:48:20.285652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.392932653427124, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    cast(null as string) as \n    \n    _fivetran_id\n    \n , \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    ad_group_id\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as boolean) as \n    \n    archived\n    \n , \n    cast(null as INT64) as \n    \n    bid\n    \n , \n    cast(null as string) as \n    \n    campaign_id\n    \n , \n    cast(null as string) as \n    \n    id\n    \n , \n    cast(null as string) as \n    \n    match_type\n    \n , \n    cast(null as string) as \n    \n    parent_type\n    \n , \n    cast(null as string) as \n    \n    value\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as keyword_id,\n        value as keyword_value,\n        _fivetran_id,\n        _fivetran_synced,\n        cast(ad_group_id as string) as ad_group_id,\n        cast(advertiser_id as string) as advertiser_id,\n        archived,\n        bid,\n        cast(campaign_id as string) as campaign_id,\n        match_type,\n        parent_type,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:19.895251Z", "completed_at": "2024-09-04T13:48:20.284210Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.285892Z", "completed_at": "2024-09-04T13:48:20.285896Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.39363813400268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_history_tmp`\n), \n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as INT64) as \n    \n    default_ad_group_budget_in_micro_currency\n    \n , \n    cast(null as boolean) as \n    \n    is_automated_campaign\n    \n , \n    cast(null as boolean) as \n    \n    is_campaign_budget_optimization\n    \n , \n    cast(null as boolean) as \n    \n    is_flexible_daily_budgets\n    \n , \n    cast(null as string) as \n    \n    id\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as string) as \n    \n    name\n    \n , \n    cast(null as string) as \n    \n    status\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as string) as campaign_id,\n        name as campaign_name,\n        cast(advertiser_id as string) as advertiser_id,\n        default_ad_group_budget_in_micro_currency,\n        is_automated_campaign,\n        is_campaign_budget_optimization,\n        is_flexible_daily_budgets,\n        status as campaign_status,\n        _fivetran_synced,\n        created_time as created_at,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.292857Z", "completed_at": "2024-09-04T13:48:20.309331Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.310104Z", "completed_at": "2024-09-04T13:48:20.310109Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022315025329589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_history_source_relation__ad_group_id___fivetran_synced.ef2b22b2ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_history`\n    group by source_relation, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.298844Z", "completed_at": "2024-09-04T13:48:20.309559Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.310295Z", "completed_at": "2024-09-04T13:48:20.310298Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022421836853027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_history_ad_group_id.220c6220be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_history`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.312677Z", "completed_at": "2024-09-04T13:48:20.317098Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.317643Z", "completed_at": "2024-09-04T13:48:20.317646Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006333112716674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_report_source_relation__date_day__advertiser_id.cadbd5fae2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report`\n    group by source_relation, date_day, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.315251Z", "completed_at": "2024-09-04T13:48:20.317456Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.318337Z", "completed_at": "2024-09-04T13:48:20.318340Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006751060485839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_advertiser_id.1b16ed73ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report`\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.319921Z", "completed_at": "2024-09-04T13:48:20.324001Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.324356Z", "completed_at": "2024-09-04T13:48:20.324359Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005610942840576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_date_day.153bd03c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.321880Z", "completed_at": "2024-09-04T13:48:20.324875Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.325805Z", "completed_at": "2024-09-04T13:48:20.325809Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006661176681518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_report_source_relation__date_day__ad_group_id__campaign_id__advertiser_id.83246fd43c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report`\n    group by source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.326546Z", "completed_at": "2024-09-04T13:48:20.330686Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.331043Z", "completed_at": "2024-09-04T13:48:20.331046Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006067991256713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_ad_group_id.bb8cf3c471", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.329072Z", "completed_at": "2024-09-04T13:48:20.331221Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.332059Z", "completed_at": "2024-09-04T13:48:20.332063Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0039691925048828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_date_day.80e8904c4c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__ad_group_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.333174Z", "completed_at": "2024-09-04T13:48:20.337798Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.338180Z", "completed_at": "2024-09-04T13:48:20.338183Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006426811218261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_history_source_relation__updated_at__advertiser_id.8308a26e9f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, updated_at, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_history`\n    group by source_relation, updated_at, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.335564Z", "completed_at": "2024-09-04T13:48:20.338354Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.339229Z", "completed_at": "2024-09-04T13:48:20.339233Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00470280647277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_history_advertiser_id.7d24f665fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__advertiser_history`\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.340353Z", "completed_at": "2024-09-04T13:48:20.344301Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.344912Z", "completed_at": "2024-09-04T13:48:20.344915Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005794048309326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_report_source_relation__date_day__campaign_id__advertiser_id.6dd9b7bce6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report`\n    group by source_relation, date_day, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.342530Z", "completed_at": "2024-09-04T13:48:20.345446Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.346227Z", "completed_at": "2024-09-04T13:48:20.346230Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004615068435668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_campaign_id.a287eba0fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.346901Z", "completed_at": "2024-09-04T13:48:20.351331Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.351750Z", "completed_at": "2024-09-04T13:48:20.351752Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006094932556152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_date_day.7ef5fb1238", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.349243Z", "completed_at": "2024-09-04T13:48:20.352274Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.353080Z", "completed_at": "2024-09-04T13:48:20.353083Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004745006561279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_report_source_relation__date_day__keyword_id__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.f43dda0239", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report`\n    group by source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.353768Z", "completed_at": "2024-09-04T13:48:20.357589Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.358062Z", "completed_at": "2024-09-04T13:48:20.358065Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005568027496337891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_date_day.9937216300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.355965Z", "completed_at": "2024-09-04T13:48:20.358597Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.359376Z", "completed_at": "2024-09-04T13:48:20.359379Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004292011260986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_keyword_id.5f00679c48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_report`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.360035Z", "completed_at": "2024-09-04T13:48:20.363744Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.364114Z", "completed_at": "2024-09-04T13:48:20.364116Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005480051040649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_history_source_relation__keyword_id__ad_group_id___fivetran_synced.2cd3b85ca9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, ad_group_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_history`\n    group by source_relation, keyword_id, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.362221Z", "completed_at": "2024-09-04T13:48:20.364294Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.365132Z", "completed_at": "2024-09-04T13:48:20.365135Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004769086837768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_history_keyword_id.246889377a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__keyword_history`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.367151Z", "completed_at": "2024-09-04T13:48:20.370851Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.371186Z", "completed_at": "2024-09-04T13:48:20.371188Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006342887878417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_history_source_relation__campaign_id___fivetran_synced.84df0386bc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_history`\n    group by source_relation, campaign_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.369203Z", "completed_at": "2024-09-04T13:48:20.371370Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.372031Z", "completed_at": "2024-09-04T13:48:20.372035Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0035462379455566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_history_campaign_id.60cb10d341", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.242639Z", "completed_at": "2024-09-04T13:48:20.610001Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.610470Z", "completed_at": "2024-09-04T13:48:20.610476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.36920905113220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_history_tmp`\n), \n\nfields as (\n\n    select\n\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    ad_group_id\n    \n , \n    cast(null as string) as \n    \n    ad_account_id\n    \n , \n    cast(null as string) as \n    \n    android_deep_link\n    \n , \n    cast(null as string) as \n    \n    click_tracking_url\n    \n , \n    cast(null as timestamp) as \n    \n    created_time\n    \n , \n    cast(null as string) as \n    \n    creative_type\n    \n , \n    cast(null as string) as \n    \n    destination_url\n    \n , \n    cast(null as string) as \n    \n    id\n    \n , \n    cast(null as string) as \n    \n    ios_deep_link\n    \n , \n    cast(null as boolean) as \n    \n    is_pin_deleted\n    \n , \n    cast(null as boolean) as \n    \n    is_removable\n    \n , \n    cast(null as string) as \n    \n    name\n    \n , \n    cast(null as string) as \n    \n    pin_id\n    \n , \n    cast(null as string) as \n    \n    review_status\n    \n , \n    cast(null as string) as \n    \n    status\n    \n , \n    cast(null as timestamp) as \n    \n    updated_time\n    \n , \n    cast(null as string) as \n    \n    view_tracking_url\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as pin_promotion_id,\n        cast(ad_account_id as string) as advertiser_id,\n        cast(ad_group_id as string) as ad_group_id,\n        created_time as created_at,\n        destination_url,\n        \n\n  \n    split(\n        destination_url,\n        '?'\n        )[safe_offset(0)]\n  \n\n as base_url,\n        \n    safe_cast(\n\n  \n    split(\n        \n\n  \n    split(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n        )[safe_offset(0)]\n  \n\n,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_host,\n        '/' || \n    safe_cast(\n\n  \n    split(\n        \n\n    case when \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ) = 0\n        then ''\n    else\n        substr(\n            \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n            -1 * (\n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ))\n        )\n    end,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_path,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_source='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_medium='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_campaign='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_content='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_term='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_term,\n        name as pin_name,\n        cast(pin_id as string) as pin_id,\n        status as pin_status,\n        creative_type,\n        _fivetran_synced,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.613102Z", "completed_at": "2024-09-04T13:48:20.625782Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.626650Z", "completed_at": "2024-09-04T13:48:20.626654Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015651226043701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_history_source_relation___fivetran_synced__pin_promotion_id.8064d48c11", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_synced, pin_promotion_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_history`\n    group by source_relation, _fivetran_synced, pin_promotion_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.615516Z", "completed_at": "2024-09-04T13:48:20.626030Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.627068Z", "completed_at": "2024-09-04T13:48:20.627071Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01583409309387207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_history_pin_promotion_id.171995cd34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_history`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.288949Z", "completed_at": "2024-09-04T13:48:20.626878Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.628255Z", "completed_at": "2024-09-04T13:48:20.628258Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.34133410453796387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report_tmp`\n), \n\nfields as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    cast(null as string) as \n    \n    ad_group_id\n    \n , \n    cast(null as string) as \n    \n    advertiser_id\n    \n , \n    cast(null as string) as \n    \n    campaign_id\n    \n , \n    cast(null as numeric) as \n    \n    clickthrough_1\n    \n , \n    cast(null as numeric) as \n    \n    clickthrough_2\n    \n , \n    cast(null as timestamp) as \n    \n    date\n    \n , \n    cast(null as numeric) as \n    \n    impression_1\n    \n , \n    cast(null as numeric) as \n    \n    impression_2\n    \n , \n    cast(null as string) as \n    \n    pin_promotion_id\n    \n , \n    cast(null as numeric) as \n    \n    spend_in_micro_dollar\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_quantity\n    \n , \n    cast(null as INT64) as \n    \n    total_conversions_value_in_micro_dollar\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(pin_promotion_id as string) as pin_promotion_id,\n        cast(ad_group_id as string) as ad_group_id,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \t\n\n\t\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.630981Z", "completed_at": "2024-09-04T13:48:20.637624Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.638041Z", "completed_at": "2024-09-04T13:48:20.638046Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008991003036499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_report_source_relation__date_day__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.8b358e3946", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report`\n    group by source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.633755Z", "completed_at": "2024-09-04T13:48:20.638251Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.639384Z", "completed_at": "2024-09-04T13:48:20.639387Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010021209716796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_date_day.ed272212a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T13:48:20.635611Z", "completed_at": "2024-09-04T13:48:20.638814Z"}, {"name": "execute", "started_at": "2024-09-04T13:48:20.639576Z", "completed_at": "2024-09-04T13:48:20.639579Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010088920593261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_pin_promotion_id.9c3c9f71ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_source_integration_tests_5_pinterest_source`.`stg_pinterest_ads__pin_promotion_report`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.7335541248321533, "args": {"invocation_command": "dbt docs generate", "project_dir": "/Users/renee/Documents/dbt/pinterest/dbt_pinterest_source/integration_tests", "send_anonymous_usage_stats": true, "defer": false, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "print": true, "exclude": [], "show_resource_report": false, "log_level_file": "debug", "partial_parse": true, "static": false, "favor_state": false, "use_colors": true, "indirect_selection": "eager", "which": "generate", "quiet": false, "empty_catalog": false, "log_format_file": "debug", "populate_cache": true, "enable_legacy_logger": false, "write_json": true, "printer_width": 80, "strict_mode": false, "introspect": true, "profiles_dir": "/Users/renee/.dbt", "select": [], "vars": {}, "static_parser": true, "log_format": "default", "log_path": "/Users/renee/Documents/dbt/pinterest/dbt_pinterest_source/integration_tests/logs", "version_check": true, "cache_selected_only": false, "use_colors_file": true, "log_level": "info", "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "compile": true}}