{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-09-04T14:16:19.248629Z", "invocation_id": "f0a832b0-091d-4623-9670-2b124a439f3a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.074512Z", "completed_at": "2024-09-04T14:16:17.119561Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.121333Z", "completed_at": "2024-09-04T14:16:17.121373Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07139396667480469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_ad_group_report_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.114147Z", "completed_at": "2024-09-04T14:16:17.119920Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.121598Z", "completed_at": "2024-09-04T14:16:17.121604Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07107305526733398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_advertiser_history_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.054604Z", "completed_at": "2024-09-04T14:16:17.120186Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.121819Z", "completed_at": "2024-09-04T14:16:17.121822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07344603538513184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_ad_group_history_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.116811Z", "completed_at": "2024-09-04T14:16:17.120425Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.122030Z", "completed_at": "2024-09-04T14:16:17.122033Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07112884521484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_advertiser_report_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.129298Z", "completed_at": "2024-09-04T14:16:17.137137Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.138533Z", "completed_at": "2024-09-04T14:16:17.138540Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014399051666259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_campaign_report_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.126756Z", "completed_at": "2024-09-04T14:16:17.137469Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.139158Z", "completed_at": "2024-09-04T14:16:17.139161Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015487909317016602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_campaign_history_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.131213Z", "completed_at": "2024-09-04T14:16:17.138080Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.140031Z", "completed_at": "2024-09-04T14:16:17.140035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015774965286254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_keyword_history_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.134193Z", "completed_at": "2024-09-04T14:16:17.138769Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.140892Z", "completed_at": "2024-09-04T14:16:17.140895Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016314029693603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_keyword_report_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.150374Z", "completed_at": "2024-09-04T14:16:17.151214Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.153900Z", "completed_at": "2024-09-04T14:16:17.153906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011540889739990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.143670Z", "completed_at": "2024-09-04T14:16:17.151534Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.154229Z", "completed_at": "2024-09-04T14:16:17.154233Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013633012771606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_pin_promotion_history_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.151795Z", "completed_at": "2024-09-04T14:16:17.152741Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.154419Z", "completed_at": "2024-09-04T14:16:17.154422Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00976109504699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_ad_group_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.146444Z", "completed_at": "2024-09-04T14:16:17.153269Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.154992Z", "completed_at": "2024-09-04T14:16:17.154995Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013695955276489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6`.`pinterest_pin_promotion_report_data`", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report_tmp`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.158763Z", "completed_at": "2024-09-04T14:16:17.159534Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.162730Z", "completed_at": "2024-09-04T14:16:17.162734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006624937057495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_advertiser_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.159910Z", "completed_at": "2024-09-04T14:16:17.160529Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.163027Z", "completed_at": "2024-09-04T14:16:17.163030Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00661778450012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_advertiser_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.160732Z", "completed_at": "2024-09-04T14:16:17.161342Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.163192Z", "completed_at": "2024-09-04T14:16:17.163195Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0066640377044677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.161683Z", "completed_at": "2024-09-04T14:16:17.162261Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.163754Z", "completed_at": "2024-09-04T14:16:17.163757Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006746768951416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_campaign_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.167033Z", "completed_at": "2024-09-04T14:16:17.167657Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.171462Z", "completed_at": "2024-09-04T14:16:17.171466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0067789554595947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_keyword_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.167978Z", "completed_at": "2024-09-04T14:16:17.168509Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.171784Z", "completed_at": "2024-09-04T14:16:17.171787Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006866931915283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_keyword_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.168680Z", "completed_at": "2024-09-04T14:16:17.169233Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.171962Z", "completed_at": "2024-09-04T14:16:17.171965Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007050037384033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_pin_promotion_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.169553Z", "completed_at": "2024-09-04T14:16:17.170961Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.172467Z", "completed_at": "2024-09-04T14:16:17.172469Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007298946380615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.pinterest_integration_tests.pinterest_pin_promotion_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.250173Z", "completed_at": "2024-09-04T14:16:17.974407Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.976219Z", "completed_at": "2024-09-04T14:16:17.976226Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.8021590709686279, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    owner_user_id\n    \n as \n    \n    owner_user_id\n    \n, \n    \n    \n    owner_username\n    \n as \n    \n    owner_username\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n        \n            \n            `permissions`\n            \n        \n    \n as advertiser_permissions , \n    \n    \n    updated_time\n    \n as \n    \n    updated_time\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as string) as advertiser_id,\n        name as advertiser_name,\n        country,\n        created_time as created_at,\n        currency as currency_code,\n        owner_user_id,\n        owner_username,\n        advertiser_permissions, -- permissions was renamed in macro\n        updated_time as updated_at,\n        row_number() over (partition by source_relation, id order by updated_time desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.253999Z", "completed_at": "2024-09-04T14:16:17.974713Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.976441Z", "completed_at": "2024-09-04T14:16:17.976445Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8018648624420166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n, \n    \n    \n    total_conversions\n    \n as \n    \n    total_conversions\n    \n, \n    \n    \n    total_conversions_quantity\n    \n as \n    \n    total_conversions_quantity\n    \n, \n    \n    \n    total_conversions_value_in_micro_dollar\n    \n as \n    \n    total_conversions_value_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.251836Z", "completed_at": "2024-09-04T14:16:17.974947Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.976688Z", "completed_at": "2024-09-04T14:16:17.976693Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8027629852294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history_tmp`\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    end_time\n    \n as \n    \n    end_time\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ad_account_id\n    \n as \n    \n    ad_account_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pacing_delivery_type\n    \n as \n    \n    pacing_delivery_type\n    \n, \n    \n    \n    placement_group\n    \n as \n    \n    placement_group\n    \n, \n    \n    \n    start_time\n    \n as \n    \n    start_time\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    summary_status\n    \n as \n    \n    summary_status\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as ad_group_id,\n        name as ad_group_name,\n        status as ad_group_status,\n        ad_account_id as advertiser_id,\n        _fivetran_synced,\n        cast(campaign_id as string) as campaign_id,\n        created_time as created_at,\n        end_time,\n        pacing_delivery_type,\n        placement_group,\n        start_time,\n        summary_status,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.176605Z", "completed_at": "2024-09-04T14:16:17.975157Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:17.976955Z", "completed_at": "2024-09-04T14:16:17.976959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8042149543762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_group_name\n    \n as \n    \n    ad_group_name\n    \n, \n    \n    \n    ad_group_status\n    \n as \n    \n    ad_group_status\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n, \n    \n    \n    total_conversions\n    \n as \n    \n    total_conversions\n    \n, \n    \n    \n    total_conversions_quantity\n    \n as \n    \n    total_conversions_quantity\n    \n, \n    \n    \n    total_conversions_value_in_micro_dollar\n    \n as \n    \n    total_conversions_value_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.987197Z", "completed_at": "2024-09-04T14:16:18.596475Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.598532Z", "completed_at": "2024-09-04T14:16:18.598546Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6186990737915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    bid\n    \n as \n    \n    bid\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    match_type\n    \n as \n    \n    match_type\n    \n, \n    \n    \n    parent_type\n    \n as \n    \n    parent_type\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as keyword_id,\n        value as keyword_value,\n        _fivetran_id,\n        _fivetran_synced,\n        cast(ad_group_id as string) as ad_group_id,\n        cast(advertiser_id as string) as advertiser_id,\n        archived,\n        bid,\n        cast(campaign_id as string) as campaign_id,\n        match_type,\n        parent_type,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.982229Z", "completed_at": "2024-09-04T14:16:18.596872Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.598794Z", "completed_at": "2024-09-04T14:16:18.598798Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6198139190673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_name\n    \n as \n    \n    campaign_name\n    \n, \n    \n    \n    campaign_status\n    \n as \n    \n    campaign_status\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n, \n    \n    \n    total_conversions\n    \n as \n    \n    total_conversions\n    \n, \n    \n    \n    total_conversions_quantity\n    \n as \n    \n    total_conversions_quantity\n    \n, \n    \n    \n    total_conversions_value_in_micro_dollar\n    \n as \n    \n    total_conversions_value_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(campaign_id as string) as campaign_id,\n        campaign_name,\n        campaign_status,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.985002Z", "completed_at": "2024-09-04T14:16:18.597168Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.599035Z", "completed_at": "2024-09-04T14:16:18.599038Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6201908588409424, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history_tmp`\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    default_ad_group_budget_in_micro_currency\n    \n as \n    \n    default_ad_group_budget_in_micro_currency\n    \n, \n    \n    \n    is_automated_campaign\n    \n as \n    \n    is_automated_campaign\n    \n, \n    \n    \n    is_campaign_budget_optimization\n    \n as \n    \n    is_campaign_budget_optimization\n    \n, \n    \n    \n    is_flexible_daily_budgets\n    \n as \n    \n    is_flexible_daily_budgets\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as string) as campaign_id,\n        name as campaign_name,\n        cast(advertiser_id as string) as advertiser_id,\n        default_ad_group_budget_in_micro_currency,\n        is_automated_campaign,\n        is_campaign_budget_optimization,\n        is_flexible_daily_budgets,\n        status as campaign_status,\n        _fivetran_synced,\n        created_time as created_at,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:17.989408Z", "completed_at": "2024-09-04T14:16:18.598234Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.601202Z", "completed_at": "2024-09-04T14:16:18.601206Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6212201118469238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report_tmp`\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_group_name\n    \n as \n    \n    ad_group_name\n    \n, \n    \n    \n    ad_group_status\n    \n as \n    \n    ad_group_status\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    keyword_id\n    \n as \n    \n    keyword_id\n    \n, \n    \n    \n    pin_promotion_id\n    \n as \n    \n    pin_promotion_id\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n, \n    \n    \n    total_conversions\n    \n as \n    \n    total_conversions\n    \n, \n    \n    \n    total_conversions_quantity\n    \n as \n    \n    total_conversions_quantity\n    \n, \n    \n    \n    total_conversions_value_in_micro_dollar\n    \n as \n    \n    total_conversions_value_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(keyword_id as string) as keyword_id,\n        cast(pin_promotion_id as string) as pin_promotion_id,\n        cast(ad_group_id as string) as ad_group_id,\n        ad_group_name,\n        ad_group_status,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.611504Z", "completed_at": "2024-09-04T14:16:18.623690Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.624180Z", "completed_at": "2024-09-04T14:16:18.624186Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02110576629638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_history_source_relation__updated_at__advertiser_id.8308a26e9f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, updated_at, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    group by source_relation, updated_at, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.619575Z", "completed_at": "2024-09-04T14:16:18.624812Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.625706Z", "completed_at": "2024-09-04T14:16:18.625709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02152228355407715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_history_advertiser_id.7d24f665fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.626468Z", "completed_at": "2024-09-04T14:16:18.636250Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.636676Z", "completed_at": "2024-09-04T14:16:18.636681Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011590242385864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__advertiser_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`\n), \n\nadvertisers as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        report.advertiser_id,\n        advertisers.currency_code,\n        advertisers.country,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report\n    left join advertisers\n        on cast(report.advertiser_id as string) = cast(advertisers.advertiser_id as string)\n        and report.source_relation = advertisers.source_relation\n    group by 1,2,3,4,5,6\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__advertiser_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.634104Z", "completed_at": "2024-09-04T14:16:18.637212Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.638074Z", "completed_at": "2024-09-04T14:16:18.638078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004909038543701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__advertiser_report_source_relation__date_day__advertiser_id.cadbd5fae2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`\n    group by source_relation, date_day, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.638738Z", "completed_at": "2024-09-04T14:16:18.643249Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.643606Z", "completed_at": "2024-09-04T14:16:18.643610Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006117105484008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_advertiser_id.1b16ed73ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.641364Z", "completed_at": "2024-09-04T14:16:18.644141Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.644948Z", "completed_at": "2024-09-04T14:16:18.644951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004499912261962891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__advertiser_report_date_day.153bd03c95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.645617Z", "completed_at": "2024-09-04T14:16:18.650125Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.650530Z", "completed_at": "2024-09-04T14:16:18.650533Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0061872005462646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_history_source_relation__ad_group_id___fivetran_synced.ef2b22b2ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n    group by source_relation, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.648458Z", "completed_at": "2024-09-04T14:16:18.651081Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.651893Z", "completed_at": "2024-09-04T14:16:18.651896Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004366159439086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_history_ad_group_id.220c6220be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.652619Z", "completed_at": "2024-09-04T14:16:18.657505Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.658032Z", "completed_at": "2024-09-04T14:16:18.658036Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0068819522857666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__ad_group_report_source_relation__date_day__ad_group_id__campaign_id__advertiser_id.83246fd43c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`\n    group by source_relation, date_day, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.655742Z", "completed_at": "2024-09-04T14:16:18.657855Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.658721Z", "completed_at": "2024-09-04T14:16:18.658723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003899812698364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_ad_group_id.bb8cf3c471", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.660337Z", "completed_at": "2024-09-04T14:16:18.665068Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.665424Z", "completed_at": "2024-09-04T14:16:18.665428Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006334066390991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__ad_group_report_date_day.80e8904c4c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.663149Z", "completed_at": "2024-09-04T14:16:18.665959Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.666804Z", "completed_at": "2024-09-04T14:16:18.666809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007252216339111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_history_source_relation__keyword_id__ad_group_id___fivetran_synced.2cd3b85ca9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, ad_group_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history`\n    group by source_relation, keyword_id, ad_group_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.667550Z", "completed_at": "2024-09-04T14:16:18.672026Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.672430Z", "completed_at": "2024-09-04T14:16:18.672433Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006231069564819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_history_keyword_id.246889377a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.670282Z", "completed_at": "2024-09-04T14:16:18.672956Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.673754Z", "completed_at": "2024-09-04T14:16:18.673758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004384040832519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_report_source_relation__date_day__campaign_id__advertiser_id.6dd9b7bce6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`\n    group by source_relation, date_day, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.674454Z", "completed_at": "2024-09-04T14:16:18.676686Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.678672Z", "completed_at": "2024-09-04T14:16:18.678676Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0055620670318603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_campaign_id.a287eba0fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.676848Z", "completed_at": "2024-09-04T14:16:18.679460Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.680269Z", "completed_at": "2024-09-04T14:16:18.680272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0077931880950927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_report_date_day.7ef5fb1238", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.680454Z", "completed_at": "2024-09-04T14:16:18.684948Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.687844Z", "completed_at": "2024-09-04T14:16:18.687848Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008507251739501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_report`\n), \n\nadvertisers as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        report.ad_group_id,\n        ad_groups.created_at,\n        ad_groups.start_time,\n        ad_groups.end_time,\n        ad_groups.ad_group_status,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__ad_group_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.685138Z", "completed_at": "2024-09-04T14:16:18.688574Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.689402Z", "completed_at": "2024-09-04T14:16:18.689405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007819652557373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith report as (\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_report`\n),\n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n),\n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        report.campaign_id,\n        campaigns.campaign_status,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report\n    left join campaigns\n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    group by 1,2,3,4,5,6,7\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__campaign_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.689581Z", "completed_at": "2024-09-04T14:16:18.693271Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.695998Z", "completed_at": "2024-09-04T14:16:18.696002Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007605075836181641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__campaign_history_source_relation__campaign_id___fivetran_synced.84df0386bc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, _fivetran_synced\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    group by source_relation, campaign_id, _fivetran_synced\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.693927Z", "completed_at": "2024-09-04T14:16:18.697283Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.701398Z", "completed_at": "2024-09-04T14:16:18.701401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008823871612548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__campaign_history_campaign_id.60cb10d341", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.697473Z", "completed_at": "2024-09-04T14:16:18.702135Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.702923Z", "completed_at": "2024-09-04T14:16:18.702926Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008577108383178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`\n), \n\nadvertisers as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n    where is_most_recent_record = True\n), \n\nkeywords as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_history`\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        advertisers.advertiser_name,\n        advertisers.advertiser_id,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_id,\n        report.keyword_id,\n        keywords.match_type,\n        keywords.parent_type,\n        keywords.keyword_value,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report\n    left join keywords\n        on report.keyword_id = keywords.keyword_id\n        and report.source_relation = keywords.source_relation\n    left join ad_groups\n        on keywords.ad_group_id = ad_groups.ad_group_id\n        and keywords.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n)\n\nselect *\nfrom fields", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__keyword_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.703098Z", "completed_at": "2024-09-04T14:16:18.706263Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.708711Z", "completed_at": "2024-09-04T14:16:18.708714Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006721973419189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__keyword_report_source_relation__date_day__keyword_id__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.f43dda0239", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`\n    group by source_relation, date_day, keyword_id, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.706890Z", "completed_at": "2024-09-04T14:16:18.709734Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.712084Z", "completed_at": "2024-09-04T14:16:18.712088Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006454944610595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_date_day.9937216300", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.710226Z", "completed_at": "2024-09-04T14:16:18.713283Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.715623Z", "completed_at": "2024-09-04T14:16:18.715626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006506919860839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__keyword_report_keyword_id.5f00679c48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__keyword_report`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.713482Z", "completed_at": "2024-09-04T14:16:18.716393Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.717194Z", "completed_at": "2024-09-04T14:16:18.717197Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0063250064849853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__advertiser_report_source_relation__advertiser_id__date_day.f9cd6d6ce2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, advertiser_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__advertiser_report`\n    group by source_relation, advertiser_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.717364Z", "completed_at": "2024-09-04T14:16:18.720080Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.723237Z", "completed_at": "2024-09-04T14:16:18.723241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006924867630004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__advertiser_report_advertiser_id.13380f0672", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect advertiser_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__advertiser_report`\nwhere advertiser_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.720272Z", "completed_at": "2024-09-04T14:16:18.723924Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.724704Z", "completed_at": "2024-09-04T14:16:18.724706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007157802581787109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__advertiser_report_date_day.aedeceeeca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__advertiser_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.724883Z", "completed_at": "2024-09-04T14:16:18.727518Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.729598Z", "completed_at": "2024-09-04T14:16:18.729602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005810976028442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__ad_group_report_source_relation__ad_group_id__advertiser_id__campaign_id__date_day.1fb5fb3f2f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, advertiser_id, campaign_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__ad_group_report`\n    group by source_relation, ad_group_id, advertiser_id, campaign_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.728003Z", "completed_at": "2024-09-04T14:16:18.730606Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.732596Z", "completed_at": "2024-09-04T14:16:18.732599Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005682945251464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__ad_group_report_ad_group_id.134f9ac6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__ad_group_report`\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.731052Z", "completed_at": "2024-09-04T14:16:18.733626Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.735850Z", "completed_at": "2024-09-04T14:16:18.735854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005873918533325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__ad_group_report_date_day.ed7c27b8a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__ad_group_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.734087Z", "completed_at": "2024-09-04T14:16:18.736722Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.737450Z", "completed_at": "2024-09-04T14:16:18.737453Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005990028381347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__campaign_report_source_relation__campaign_id__advertiser_id__date_day.4da70e098b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, advertiser_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__campaign_report`\n    group by source_relation, campaign_id, advertiser_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.737620Z", "completed_at": "2024-09-04T14:16:18.744546Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.745113Z", "completed_at": "2024-09-04T14:16:18.745116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008648872375488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__campaign_report_campaign_id.8001ea60f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__campaign_report`\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.740776Z", "completed_at": "2024-09-04T14:16:18.745275Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.746118Z", "completed_at": "2024-09-04T14:16:18.746121Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006335258483886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__campaign_report_date_day.10ac8272bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__campaign_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.747274Z", "completed_at": "2024-09-04T14:16:18.752577Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.753139Z", "completed_at": "2024-09-04T14:16:18.753142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007283926010131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__keyword_report_source_relation__keyword_id__ad_group_id__campaign_id__advertiser_id__date_day.a9ce89d1db", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, ad_group_id, campaign_id, advertiser_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__keyword_report`\n    group by source_relation, keyword_id, ad_group_id, campaign_id, advertiser_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.749872Z", "completed_at": "2024-09-04T14:16:18.752962Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.753797Z", "completed_at": "2024-09-04T14:16:18.753801Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0049479007720947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__keyword_report_date_day.23130e9fba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__keyword_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.754987Z", "completed_at": "2024-09-04T14:16:18.756728Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:18.757048Z", "completed_at": "2024-09-04T14:16:18.757051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027740001678466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__keyword_report_keyword_id.0d73460198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__keyword_report`\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.608758Z", "completed_at": "2024-09-04T14:16:19.188555Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.189506Z", "completed_at": "2024-09-04T14:16:19.189512Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5869841575622559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report_tmp`\n), \n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    advertiser_id\n    \n as \n    \n    advertiser_id\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clickthrough_1\n    \n as \n    \n    clickthrough_1\n    \n, \n    \n    \n    clickthrough_2\n    \n as \n    \n    clickthrough_2\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impression_1\n    \n as \n    \n    impression_1\n    \n, \n    \n    \n    impression_2\n    \n as \n    \n    impression_2\n    \n, \n    \n    \n    pin_promotion_id\n    \n as \n    \n    pin_promotion_id\n    \n, \n    \n    \n    spend_in_micro_dollar\n    \n as \n    \n    spend_in_micro_dollar\n    \n, \n    \n    \n    total_conversions\n    \n as \n    \n    total_conversions\n    \n, \n    \n    \n    total_conversions_quantity\n    \n as \n    \n    total_conversions_quantity\n    \n, \n    \n    \n    total_conversions_value_in_micro_dollar\n    \n as \n    \n    total_conversions_value_in_micro_dollar\n    \n\n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation, \n        timestamp_trunc(\n        cast(date as timestamp),\n        day\n    ) as date_day,\n        cast(pin_promotion_id as string) as pin_promotion_id,\n        cast(ad_group_id as string) as ad_group_id,\n        cast(campaign_id as string) as campaign_id,\n        cast(advertiser_id as string) as advertiser_id,\n        coalesce(impression_1,0) + coalesce(impression_2,0) as impressions,\n        coalesce(clickthrough_1,0) + coalesce(clickthrough_2,0) as clicks,\n        spend_in_micro_dollar / 1000000.0 as spend,\n        total_conversions,\n        total_conversions_quantity,\n        total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:18.605023Z", "completed_at": "2024-09-04T14:16:19.188793Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.189727Z", "completed_at": "2024-09-04T14:16:19.189731Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5877339839935303, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest_source.stg_pinterest_ads__pin_promotion_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history_tmp`\n), \n\nfields as (\n\n    select\n\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_account_id\n    \n as \n    \n    ad_account_id\n    \n, \n    cast(null as string) as \n    \n    android_deep_link\n    \n , \n    cast(null as string) as \n    \n    click_tracking_url\n    \n , \n    \n    \n    created_time\n    \n as \n    \n    created_time\n    \n, \n    \n    \n    creative_type\n    \n as \n    \n    creative_type\n    \n, \n    \n    \n    destination_url\n    \n as \n    \n    destination_url\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as string) as \n    \n    ios_deep_link\n    \n , \n    cast(null as boolean) as \n    \n    is_pin_deleted\n    \n , \n    cast(null as boolean) as \n    \n    is_removable\n    \n , \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pin_id\n    \n as \n    \n    pin_id\n    \n, \n    cast(null as string) as \n    \n    review_status\n    \n , \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    cast(null as timestamp) as \n    \n    updated_time\n    \n , \n    cast(null as string) as \n    \n    view_tracking_url\n    \n \n\n\n    \n        \n\n\n, cast('' as string) as source_relation\n\n\n\n\n    from base\n), \n\nfinal as (\n\n    select\n        source_relation,\n        cast(id as string) as pin_promotion_id,\n        cast(ad_account_id as string) as advertiser_id,\n        cast(ad_group_id as string) as ad_group_id,\n        created_time as created_at,\n        destination_url,\n        \n\n  \n    split(\n        destination_url,\n        '?'\n        )[safe_offset(0)]\n  \n\n as base_url,\n        \n    safe_cast(\n\n  \n    split(\n        \n\n  \n    split(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n        )[safe_offset(0)]\n  \n\n,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_host,\n        '/' || \n    safe_cast(\n\n  \n    split(\n        \n\n    case when \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ) = 0\n        then ''\n    else\n        substr(\n            \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n            -1 * (\n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/'\n\n    ), 0),\n            \n\n    strpos(\n        \n\n    replace(\n        \n\n    replace(\n        destination_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '?'\n\n    ) - 1\n            ))\n        )\n    end,\n        '?'\n        )[safe_offset(0)]\n  \n\n as string)\n as url_path,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_source='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_medium='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_campaign='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_content='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    split(\n        \n\n  \n    split(\n        destination_url,\n        'utm_term='\n        )[safe_offset(1)]\n  \n\n,\n        '&'\n        )[safe_offset(0)]\n  \n\n,'') as utm_term,\n        name as pin_name,\n        cast(pin_id as string) as pin_id,\n        status as pin_status,\n        creative_type,\n        _fivetran_synced,\n        row_number() over (partition by source_relation, id order by _fivetran_synced desc) = 1 as is_most_recent_record\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.193758Z", "completed_at": "2024-09-04T14:16:19.205219Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.206664Z", "completed_at": "2024-09-04T14:16:19.206669Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015960693359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_report_source_relation__date_day__pin_promotion_id__ad_group_id__campaign_id__advertiser_id.8b358e3946", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n    group by source_relation, date_day, pin_promotion_id, ad_group_id, campaign_id, advertiser_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.198226Z", "completed_at": "2024-09-04T14:16:19.205452Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.206903Z", "completed_at": "2024-09-04T14:16:19.206907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015716075897216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_pin_promotion_id.9c3c9f71ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.196085Z", "completed_at": "2024-09-04T14:16:19.205658Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.207299Z", "completed_at": "2024-09-04T14:16:19.207302Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01662278175354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_report_date_day.ed272212a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.200905Z", "completed_at": "2024-09-04T14:16:19.206268Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.208348Z", "completed_at": "2024-09-04T14:16:19.208351Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016792774200439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__pin_promotion_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n), \n\npins as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        campaigns.advertiser_id,\n        advertisers.advertiser_name,\n        report.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        report.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        pins.creative_type,\n        report.pin_promotion_id,\n        pins.pin_name,\n        pins.pin_status,\n        pins.destination_url,\n        pins.base_url,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report \n    left join pins \n        on report.pin_promotion_id = pins.pin_promotion_id\n        and report.source_relation = pins.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns \n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16\n)\n\nselect * \nfrom joined", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__pin_promotion_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.216134Z", "completed_at": "2024-09-04T14:16:19.223097Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.224489Z", "completed_at": "2024-09-04T14:16:19.224493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01512908935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.dbt_utils_unique_combination_of_columns_stg_pinterest_ads__pin_promotion_history_source_relation___fivetran_synced__pin_promotion_id.8064d48c11", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, _fivetran_synced, pin_promotion_id\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    group by source_relation, _fivetran_synced, pin_promotion_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.220309Z", "completed_at": "2024-09-04T14:16:19.223305Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.224679Z", "completed_at": "2024-09-04T14:16:19.224681Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014153003692626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__pin_promotion_report_source_relation__pin_promotion_id__ad_group_id__campaign_id__advertiser_id__date_day.9d2f1ea810", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, pin_promotion_id, ad_group_id, campaign_id, advertiser_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__pin_promotion_report`\n    group by source_relation, pin_promotion_id, ad_group_id, campaign_id, advertiser_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.211855Z", "completed_at": "2024-09-04T14:16:19.223491Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.224863Z", "completed_at": "2024-09-04T14:16:19.224865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01616692543029785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.pinterest.pinterest_ads__url_report", "compiled": true, "compiled_code": "\n\nwith report as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_report`\n), \n\npins as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__ad_group_history`\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__campaign_history`\n    where is_most_recent_record = True\n),\n\nadvertisers as (\n\n    select *\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__advertiser_history`\n    where is_most_recent_record = True\n), \n\njoined as (\n\n    select\n        report.source_relation,\n        report.date_day,\n        campaigns.advertiser_id,\n        advertisers.advertiser_name,\n        report.campaign_id,\n        campaigns.campaign_name,\n        campaigns.campaign_status,\n        report.ad_group_id,\n        ad_groups.ad_group_name,\n        ad_groups.ad_group_status,\n        pins.destination_url,\n        pins.creative_type,\n        report.pin_promotion_id,\n        pins.pin_name,\n        pins.pin_status,\n        pins.base_url,\n        pins.url_host,\n        pins.url_path,\n        pins.utm_source,\n        pins.utm_medium,\n        pins.utm_campaign,\n        pins.utm_content,\n        pins.utm_term,\n        sum(report.spend) as spend,\n        sum(report.clicks) as clicks,\n        sum(report.impressions) as impressions,\n        sum(report.total_conversions) as total_conversions,\n        sum(report.total_conversions_quantity) as total_conversions_quantity,\n        sum(report.total_conversions_value_in_micro_dollar) as total_conversions_value_in_micro_dollar\n\n        \n\n\n\n\n\n    from report \n    left join pins \n        on report.pin_promotion_id = pins.pin_promotion_id\n        and report.source_relation = pins.source_relation\n    left join ad_groups\n        on report.ad_group_id = ad_groups.ad_group_id\n        and report.source_relation = ad_groups.source_relation\n    left join campaigns \n        on report.campaign_id = campaigns.campaign_id\n        and report.source_relation = campaigns.source_relation\n    left join advertisers\n        on campaigns.advertiser_id = advertisers.advertiser_id\n        and campaigns.source_relation = advertisers.source_relation\n\n    \n    where pins.destination_url is not null\n    \n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23\n)\n\nselect * \nfrom joined", "relation_name": "`dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__url_report`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.218046Z", "completed_at": "2024-09-04T14:16:19.223667Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.225035Z", "completed_at": "2024-09-04T14:16:19.225037Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01587510108947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest_source.not_null_stg_pinterest_ads__pin_promotion_history_pin_promotion_id.171995cd34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`stg_pinterest_ads__pin_promotion_history`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.229201Z", "completed_at": "2024-09-04T14:16:19.237416Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.238798Z", "completed_at": "2024-09-04T14:16:19.238803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012181758880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__pin_promotion_report_date_day.3128d28cfd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__pin_promotion_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.232682Z", "completed_at": "2024-09-04T14:16:19.237615Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.238981Z", "completed_at": "2024-09-04T14:16:19.238984Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011996030807495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.dbt_utils_unique_combination_of_columns_pinterest_ads__url_report_source_relation__pin_promotion_id__ad_group_id__campaign_id__advertiser_id__date_day.688d8bd291", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, pin_promotion_id, ad_group_id, campaign_id, advertiser_id, date_day\n    from `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__url_report`\n    group by source_relation, pin_promotion_id, ad_group_id, campaign_id, advertiser_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.231051Z", "completed_at": "2024-09-04T14:16:19.237813Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.239176Z", "completed_at": "2024-09-04T14:16:19.239179Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012601852416992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__pin_promotion_report_pin_promotion_id.2540e0a561", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__pin_promotion_report`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.235539Z", "completed_at": "2024-09-04T14:16:19.237973Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.239354Z", "completed_at": "2024-09-04T14:16:19.239357Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012398958206176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__url_report_date_day.b09048037e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__url_report`\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.242227Z", "completed_at": "2024-09-04T14:16:19.246035Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.246645Z", "completed_at": "2024-09-04T14:16:19.246648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0056841373443603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__url_report_destination_url.0bb7f30502", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_url\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__url_report`\nwhere destination_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-04T14:16:19.244051Z", "completed_at": "2024-09-04T14:16:19.246212Z"}, {"name": "execute", "started_at": "2024-09-04T14:16:19.246806Z", "completed_at": "2024-09-04T14:16:19.246808Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005742073059082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.pinterest.not_null_pinterest_ads__url_report_pin_promotion_id.0da711ad6a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect pin_promotion_id\nfrom `dbt-package-testing`.`pinterest_integration_tests_6_pinterest_ads_dev`.`pinterest_ads__url_report`\nwhere pin_promotion_id is null\n\n\n", "relation_name": null}], "elapsed_time": 4.059807062149048, "args": {"log_path": "/Users/renee/Documents/dbt/pinterest/dbt_pinterest/integration_tests/logs", "enable_legacy_logger": false, "strict_mode": false, "send_anonymous_usage_stats": true, "cache_selected_only": false, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "introspect": true, "indirect_selection": "eager", "printer_width": 80, "macro_debugging": false, "exclude": [], "static_parser": true, "log_format": "default", "which": "generate", "compile": true, "version_check": true, "log_level_file": "debug", "log_level": "info", "print": true, "project_dir": "/Users/renee/Documents/dbt/pinterest/dbt_pinterest/integration_tests", "quiet": false, "select": [], "static": false, "log_file_max_bytes": 10485760, "show_resource_report": false, "use_colors_file": true, "log_format_file": "debug", "favor_state": false, "vars": {}, "profiles_dir": "/Users/renee/.dbt", "partial_parse": true, "partial_parse_file_diff": true, "use_colors": true, "invocation_command": "dbt docs generate", "empty_catalog": false, "write_json": true}}